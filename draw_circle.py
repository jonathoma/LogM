from sage.plot.bezier_path import bezier_path
from sage.plot.colors import rainbow
from sage.plot.text import Text

angles =[[0.333333, 0.666667],
[0.142857, 0.285714],
[0.428571, 0.571429],
[0.714286, 0.857143],
[0.0666667, 0.133333],
[0.2, 0.266667],
[0.4, 0.6],
[0.466667, 0.533333],
[0.733333, 0.8],
[0.866667, 0.933333],
[0.0322581, 0.0645161],
[0.0967742, 0.129032],
[0.16129 ,0.193548],
[0.225806, 0.258065],
[0.290323, 0.322581],
[0.354839, 0.387097],
[0.419355, 0.580645],
[0.451613, 0.548387],
[0.483871 ,0.516129],
[0.612903 ,0.645161],
[0.677419, 0.709677],
[0.741935, 0.774194],
[0.806452, 0.83871],
[0.870968, 0.903226],
[0.935484, 0.967742],
[0.015873, 0.031746],
[0.047619, 0.0634921],
[0.0793651, 0.0952381],
[0.111111, 0.126984],
[0.15873 ,0.269841],
[0.174603, 0.190476],
[0.206349, 0.222222],
[0.238095, 0.253968],
[0.301587, 0.31746],
[0.349206, 0.396825],
[0.365079, 0.380952],
[0.412698, 0.587302],
[0.444444, 0.555556],
[0.460317, 0.539683],
[0.47619, 0.52381],
[0.492063, 0.507937],
[0.603175, 0.650794],
[0.619048, 0.634921],
[0.68254 ,0.698413],
[0.730159, 0.84127],
[0.746032, 0.761905],
[0.777778, 0.793651],
[0.809524, 0.825397],
[0.873016, 0.888889],
[0.904762, 0.920635],
[0.936508, 0.952381],
[0.968254, 0.984127],
[0.00787402, 0.015748],
[0.023622 ,0.0314961],
[0.0393701, 0.0472441],
[0.0551181, 0.0629921],
[0.0708661, 0.0787402],
[0.0866142, 0.0944882],
[0.102362, 0.110236],
[0.11811, 0.125984],
[0.133858, 0.141732],
[0.149606, 0.15748],
[0.165354, 0.173228],
[0.181102, 0.188976],
[0.19685 ,0.267717],
[0.204724, 0.259843],
[0.212598, 0.220472],
[0.228346, 0.23622],
[0.244094, 0.251969],
[0.275591, 0.283465],
[0.291339, 0.299213],
[0.307087, 0.314961],
[0.322835, 0.330709],
[0.338583, 0.346457],
[0.354331, 0.393701],
[0.362205, 0.385827],
[0.370079, 0.377953],
[0.401575, 0.409449],
[0.417323, 0.582677],
[0.425197, 0.574803],
[0.433071, 0.440945],
[0.448819, 0.551181],
[0.456693, 0.543307],
[0.464567, 0.535433],
[0.472441, 0.527559],
[0.480315, 0.519685],
[0.488189, 0.511811],
[0.496063, 0.503937],
[0.559055, 0.566929],
[0.590551, 0.598425],
[0.606299, 0.645669],
[0.614173, 0.637795],
[0.622047, 0.629921],
[0.653543, 0.661417],
[0.669291, 0.677165],
[0.685039, 0.692913],
[0.700787, 0.708661],
[0.716535, 0.724409],
[0.732283, 0.80315],
[0.740157, 0.795276],
[0.748031, 0.755906],
[0.76378 ,0.771654],
[0.779528, 0.787402],
[0.811024, 0.818898],
[0.826772, 0.834646],
[0.84252, 0.850394],
[0.858268 ,0.866142],
[0.874016 ,0.88189],
[0.889764, 0.897638],
[0.905512, 0.913386],
[0.92126 ,0.929134],
[0.937008, 0.944882],
[0.952756, 0.96063],
[0.968504, 0.976378],
[0.984252 ,0.992126],
[0.00392157, 0.00784314],
[0.0117647, 0.0156863],
[0.0196078, 0.0235294],
[0.027451 ,0.0313725],
[0.0352941, 0.0392157],
[0.0431373, 0.0470588],
[0.0509804, 0.054902],
[0.0588235, 0.0627451],
[0.0705882, 0.129412],
[0.0745098, 0.0784314],
[0.0823529, 0.0862745],
[0.0901961, 0.0941176],
[0.0980392, 0.101961],
[0.105882, 0.109804],
[0.113725, 0.117647],
[0.121569, 0.12549],
[0.137255, 0.141176],
[0.145098, 0.14902],
[0.152941, 0.156863],
[0.160784, 0.196078],
[0.164706, 0.192157],
[0.168627, 0.172549],
[0.176471, 0.180392],
[0.184314, 0.188235],
[0.203922, 0.262745],
[0.207843, 0.211765],
[0.215686, 0.219608],
[0.223529, 0.258824],
[0.227451, 0.254902],
[0.231373, 0.235294],
[0.239216, 0.243137],
[0.247059, 0.25098],
[0.270588 ,0.27451],
[0.278431, 0.282353],
[0.286275, 0.290196],
[0.294118, 0.298039],
[0.301961, 0.305882],
[0.309804, 0.313725],
[0.317647, 0.321569],
[0.32549 ,0.329412],
[0.337255, 0.34902],
[0.341176, 0.345098],
[0.352941, 0.396078],
[0.356863, 0.360784],
[0.364706, 0.384314],
[0.368627, 0.380392],
[0.372549, 0.376471],
[0.388235, 0.392157],
[0.403922, 0.407843],
[0.411765, 0.588235],
[0.415686, 0.584314],
[0.419608, 0.423529],
[0.427451, 0.572549],
[0.431373, 0.443137],
[0.435294, 0.439216],
[0.447059, 0.552941],
[0.45098 ,0.54902],
[0.454902, 0.545098],
[0.458824, 0.541176],
[0.462745, 0.537255],
[0.470588, 0.529412],
[0.47451 ,0.52549],
[0.478431, 0.521569],
[0.482353, 0.517647],
[0.486275, 0.513725],
[0.490196, 0.509804],
[0.494118, 0.505882],
[0.498039, 0.501961],
[0.556863, 0.568627],
[0.560784, 0.564706],
[0.576471, 0.580392],
[0.592157, 0.596078],
[0.603922, 0.647059],
[0.607843, 0.611765],
[0.615686, 0.635294],
[0.619608, 0.631373],
[0.623529, 0.627451],
[0.639216, 0.643137],
[0.65098 ,0.662745],
[0.654902, 0.658824],
[0.670588, 0.67451],
[0.678431, 0.682353],
[0.686275, 0.690196],
[0.694118, 0.698039],
[0.701961, 0.705882],
[0.709804, 0.713725],
[0.717647, 0.721569],
[0.72549 ,0.729412],
[0.737255, 0.796078],
[0.741176, 0.776471],
[0.745098, 0.772549],
[0.74902 ,0.752941],
[0.756863, 0.760784],
[0.764706, 0.768627],
[0.780392, 0.784314],
[0.788235, 0.792157],
[0.803922, 0.839216],
[0.807843, 0.835294],
[0.811765, 0.815686],
[0.819608, 0.823529],
[0.827451, 0.831373],
[0.843137, 0.847059],
[0.85098 ,0.854902],
[0.858824, 0.862745],
[0.870588, 0.929412],
[0.87451, 0.878431],
[0.882353, 0.886275],
[0.890196, 0.894118],
[0.898039, 0.901961],
[0.905882, 0.909804],
[0.913725, 0.917647],
[0.921569, 0.92549],
[0.937255, 0.941176],
[0.945098, 0.94902],
[0.952941, 0.956863],
[0.960784, 0.964706],
[0.968627, 0.972549],
[0.976471, 0.980392],
[0.984314, 0.988235],
[0.992157, 0.996078],
[0.00195695, 0.00391389],
[0.00587084, 0.00782779],
[0.00978474, 0.0117417],
[0.0136986, 0.0156556],
[0.0176125, 0.0195695],
[0.0215264, 0.0234834],
[0.0254403, 0.0273973],
[0.0293542, 0.0313112],
[0.0332681, 0.035225],
[0.037182 ,0.0391389],
[0.0410959, 0.0430528],
[0.0450098, 0.0469667],
[0.0489237, 0.0508806],
[0.0528376, 0.0547945],
[0.0567515, 0.0587084],
[0.0606654, 0.0626223],
[0.0645793, 0.0665362],
[0.0684932, 0.0704501],
[0.072407, 0.074364],
[0.0763209, 0.0782779],
[0.0802348, 0.0821918],
[0.0841487, 0.0861057],
[0.0880626, 0.0900196],
[0.0919765, 0.0939335],
[0.0958904, 0.129159],
[0.0978474, 0.127202],
[0.0998043, 0.101761],
[0.103718, 0.105675],
[0.107632, 0.109589],
[0.111546, 0.113503],
[0.11546 ,0.117417],
[0.119374, 0.121331],
[0.123288, 0.125245],
[0.131115, 0.133072],
[0.135029, 0.136986],
[0.138943, 0.1409],
[0.144814, 0.158513],
[0.146771, 0.148728],
[0.150685, 0.152642],
[0.154599, 0.156556],
[0.16047 ,0.268102],
[0.162427, 0.164384],
[0.166341, 0.168297],
[0.170254, 0.172211],
[0.174168, 0.191781],
[0.176125, 0.189824],
[0.178082, 0.180039],
[0.181996, 0.183953],
[0.18591 ,0.187867],
[0.193738, 0.195695],
[0.197652, 0.199609],
[0.201566, 0.203523],
[0.205479, 0.223092],
[0.207436, 0.221135],
[0.209393, 0.21135],
[0.213307, 0.215264],
[0.217221, 0.219178],
[0.225049, 0.258317],
[0.227006, 0.25636],
[0.228963, 0.23092],
[0.232877, 0.234834],
[0.236791, 0.254403],
[0.238748, 0.252446],
[0.240705, 0.242661],
[0.244618, 0.246575],
[0.248532, 0.250489],
[0.260274, 0.262231],
[0.264188, 0.266145],
[0.270059, 0.283757],
[0.272016, 0.273973],
[0.27593 ,0.277886],
[0.279843, 0.2818],
[0.287671, 0.289628],
[0.291585, 0.293542],
[0.295499, 0.297456],
[0.299413, 0.30137],
[0.303327, 0.305284],
[0.307241, 0.309198],
[0.311155, 0.313112],
[0.315068, 0.317025],
[0.318982, 0.320939],
[0.322896, 0.324853],
[0.32681 ,0.328767],
[0.330724, 0.332681],
[0.334638, 0.336595],
[0.338552, 0.348337],
[0.340509, 0.34638],
[0.342466, 0.344423],
[0.350294, 0.35225],
[0.354207, 0.395303],
[0.356164, 0.362035],
[0.358121, 0.360078],
[0.363992, 0.385519],
[0.365949, 0.367906],
[0.369863, 0.379648],
[0.37182 ,0.377691],
[0.373777, 0.375734],
[0.381605, 0.383562],
[0.387476, 0.393346],
[0.389432, 0.391389],
[0.39726 ,0.399217],
[0.401174, 0.410959],
[0.403131, 0.409002],
[0.405088, 0.407045],
[0.412916, 0.414873],
[0.41683 ,0.58317],
[0.418787, 0.581213],
[0.420744, 0.422701],
[0.424658, 0.575342],
[0.426614, 0.573386],
[0.430528, 0.444227],
[0.432485, 0.44227],
[0.434442, 0.440313],
[0.436399, 0.438356],
[0.446184, 0.553816],
[0.448141, 0.551859],
[0.450098, 0.549902],
[0.452055, 0.454012],
[0.455969, 0.544031],
[0.457926, 0.542074],
[0.459883, 0.540117],
[0.46184 ,0.53816],
[0.463796, 0.536204],
[0.465753, 0.534247],
[0.46771 ,0.469667],
[0.471624, 0.528376],
[0.473581, 0.526419],
[0.475538, 0.524462],
[0.477495, 0.522505],
[0.479452, 0.520548],
[0.481409, 0.518591],
[0.483366, 0.516634],
[0.485323, 0.514677],
[0.48728, 0.51272],
[0.489237, 0.510763],
[0.491194, 0.508806],
[0.493151, 0.506849],
[0.495108, 0.504892],
[0.497065, 0.502935],
[0.499022, 0.500978],
[0.530333, 0.53229],
[0.545988, 0.547945],
[0.555773, 0.569472],
[0.55773, 0.567515],
[0.559687, 0.565558],
[0.561644, 0.563601],
[0.577299, 0.579256],
[0.585127, 0.587084],
[0.589041, 0.598826],
[0.590998, 0.596869],
[0.592955, 0.594912],
[0.600783, 0.60274],
[0.604697, 0.645793],
[0.606654, 0.612524],
[0.608611, 0.610568],
[0.614481, 0.636008],
[0.616438, 0.618395],
[0.620352, 0.630137],
[0.622309, 0.62818],
[0.624266, 0.626223],
[0.632094, 0.634051],
[0.637965, 0.643836],
[0.639922, 0.641879],
[0.64775, 0.649706],
[0.651663, 0.661448],
[0.65362, 0.659491],
[0.655577, 0.657534],
[0.663405, 0.665362],
[0.667319, 0.669276],
[0.671233, 0.67319],
[0.675147, 0.677104],
[0.679061, 0.681018],
[0.682975, 0.684932],
[0.686888, 0.688845],
[0.690802, 0.692759],
[0.694716, 0.696673],
[0.69863, 0.700587],
[0.702544, 0.704501],
[0.706458, 0.708415],
[0.710372, 0.712329],
[0.716243, 0.729941],
[0.7182, 0.720157],
[0.722114, 0.72407],
[0.726027, 0.727984],
[0.731898, 0.83953],
[0.733855, 0.735812],
[0.737769, 0.739726],
[0.741683, 0.774951],
[0.74364, 0.772994],
[0.745597, 0.763209],
[0.747554, 0.761252],
[0.749511, 0.751468],
[0.753425, 0.755382],
[0.757339, 0.759295],
[0.765166, 0.767123],
[0.76908, 0.771037],
[0.776908, 0.794521],
[0.778865, 0.792564],
[0.780822, 0.782779],
[0.784736, 0.786693],
[0.78865, 0.790607],
[0.796477, 0.798434],
[0.800391, 0.802348],
[0.804305, 0.806262],
[0.808219, 0.825832],
[0.810176, 0.823875],
[0.812133, 0.81409],
[0.816047, 0.818004],
[0.819961, 0.821918],
[0.827789, 0.829746],
[0.831703, 0.833659],
[0.835616, 0.837573],
[0.841487, 0.855186],
[0.843444, 0.845401],
[0.847358, 0.849315],
[0.851272, 0.853229],
[0.8591, 0.861057],
[0.863014, 0.864971],
[0.866928, 0.868885],
[0.870841, 0.90411],
[0.872798, 0.902153],
[0.874755, 0.876712],
[0.878669, 0.880626],
[0.882583, 0.88454],
[0.886497, 0.888454],
[0.890411, 0.892368],
[0.894325, 0.896282],
[0.898239, 0.900196],
[0.906067, 0.908023],
[0.90998, 0.911937],
[0.913894, 0.915851],
[0.917808, 0.919765],
[0.921722, 0.923679],
[0.925636, 0.927593],
[0.92955, 0.931507],
[0.933464, 0.935421],
[0.937378, 0.939335],
[0.941292, 0.943249],
[0.945205, 0.947162],
[0.949119, 0.951076],
[0.953033, 0.95499],
[0.956947, 0.958904],
[0.960861, 0.962818],
[0.964775, 0.966732],
[0.968689, 0.970646],
[0.972603, 0.97456],
[0.976517, 0.978474],
[0.980431, 0.982387],
[0.984344, 0.986301],
[0.988258, 0.990215],
[0.992172, 0.994129],
[0.996086, 0.998043]]

def get_point_from_angle(a):
    p1 = cos(2 * pi * a)
    p2 = sin(2 * pi * a) 
    return (p1, p2)

def get_center(p1, p2):
    slope_1 = -p1[0] * 1.0 / p1[1]
    slope_2 = -p2[0] * 1.0 / p2[1]
    x, y = var('x, y')
    sol = solve([y == slope_2 * (x - p2[0]) + p2[1], 
                 y == slope_1 * (x - p1[0]) + p1[1]], 
                 x, y,
                 solution_dict = True)
    return (n(sol[0][x]), n(sol[0][y]))

def distance(p1, p2):
    return n(sqrt((p2[0] - p1[0])**2 + (p2[1] - p1[1])**2))

if __name__ == "__main__":
    disp = circle((0,0), 1)
    #angles = [[1./3, 2./3], [1./7, 2./7], [3./7, 4./7], [11./31, 12./31]]
    global angles
    colors = rainbow(len(angles))

    for i, pair in enumerate(angles):
        # Get points associated with angles
        p1 = get_point_from_angle(pair[0])
        p2 = get_point_from_angle(pair[1])
        #disp += text("%s" % pair[0], p1, fontsize = 'xx-small')

        # Get arc between points
        center = get_center(p1, p2)
        radius = distance(center, p1)
        disp += arc(center, radius, rgbcolor = colors[i], thickness = 0.8)
        #disp += bezier_path([[p1, (0,0), p2]], thickness = 0.5, rgbcolor = colors[i])
    disp.axes(False)
    disp.show(dpi = 1000,
              title = "External Angles in the Mandlebrot Set", 
              xmin = -1, xmax = 1, 
              ymin = -1, ymax = 1)
    
